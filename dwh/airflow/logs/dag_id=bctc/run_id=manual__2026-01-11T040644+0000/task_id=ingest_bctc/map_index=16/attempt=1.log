[2026-01-11T04:12:02.638+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2026-01-11T04:12:02.656+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: bctc.ingest_bctc manual__2026-01-11T04:06:44+00:00 map_index=16 [queued]>
[2026-01-11T04:12:02.667+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: bctc.ingest_bctc manual__2026-01-11T04:06:44+00:00 map_index=16 [queued]>
[2026-01-11T04:12:02.667+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2026-01-11T04:12:02.681+0000] {taskinstance.py:2330} INFO - Executing <Mapped(DfToCsvOperator): ingest_bctc> on 2026-01-11 04:06:44+00:00
[2026-01-11T04:12:02.691+0000] {warnings.py:112} WARNING - This process (pid=2847) is multi-threaded, use of fork() may lead to deadlocks in the child.

[2026-01-11T04:12:02.693+0000] {standard_task_runner.py:64} INFO - Started process 2870 to run task
[2026-01-11T04:12:02.694+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'bctc', 'ingest_bctc', 'manual__2026-01-11T04:06:44+00:00', '--job-id', '10296', '--raw', '--subdir', 'DAGS_FOLDER/tt_cty_bctc.py', '--cfg-path', '/tmp/tmp7bajc4ct', '--map-index', '16']
[2026-01-11T04:12:02.695+0000] {standard_task_runner.py:91} INFO - Job 10296: Subtask ingest_bctc
[2026-01-11T04:12:02.740+0000] {task_command.py:426} INFO - Running <TaskInstance: bctc.ingest_bctc manual__2026-01-11T04:06:44+00:00 map_index=16 [running]> on host 3f2af93df813
[2026-01-11T04:12:02.836+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='bctc' AIRFLOW_CTX_TASK_ID='ingest_bctc' AIRFLOW_CTX_EXECUTION_DATE='2026-01-11T04:06:44+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2026-01-11T04:06:44+00:00'
[2026-01-11T04:12:02.838+0000] {taskinstance.py:430} INFO - ::endgroup::
[2026-01-11T04:12:02.845+0000] {logging_mixin.py:188} INFO - Bắt đầu xử lý batch 20 mã: ['TID', 'THW', 'THU', 'THT', 'THS', 'THP', 'THN', 'THM', 'THI', 'THG', 'THD', 'THB', 'TH1', 'TGP', 'TGG', 'TFC', 'TET', 'TEL', 'TEG', 'TED']
[2026-01-11T04:12:02.846+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: TID
[2026-01-11T04:12:11.703+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THW
[2026-01-11T04:12:25.042+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THU
[2026-01-11T04:12:29.962+0000] {logging_mixin.py:188} INFO - ❌ Lỗi income_statement: RetryError[<Future at 0x7f49d6928d70 state=finished raised ConnectionError>]
[2026-01-11T04:12:36.123+0000] {logging_mixin.py:188} INFO - ❌ Lỗi balance_sheet: RetryError[<Future at 0x7f49d4ccac60 state=finished raised KeyError>]
[2026-01-11T04:12:42.213+0000] {logging_mixin.py:188} INFO - ❌ Lỗi cash_flow: RetryError[<Future at 0x7f49d4cc9bb0 state=finished raised KeyError>]
[2026-01-11T04:12:45.705+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THT
[2026-01-11T04:12:56.914+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THS
[2026-01-11T04:13:05.708+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THP
[2026-01-11T04:13:15.061+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THN
[2026-01-11T04:13:23.425+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THM
[2026-01-11T04:13:38.272+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THI
[2026-01-11T04:13:50.382+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THG
[2026-01-11T04:13:58.932+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THD
[2026-01-11T04:14:07.092+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: THB
[2026-01-11T04:14:07.478+0000] {logging_mixin.py:188} INFO -  Lỗi xử lý mã THB: Failed to fetch data: 429 - Too Many Requests
[2026-01-11T04:14:07.478+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: TH1
[2026-01-11T04:14:18.209+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: TGP
[2026-01-11T04:14:18.551+0000] {logging_mixin.py:188} INFO -  Lỗi xử lý mã TGP: Failed to fetch data: 429 - Too Many Requests
[2026-01-11T04:14:18.552+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: TGG
[2026-01-11T04:14:29.414+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: TFC
[2026-01-11T04:14:38.004+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: TET
[2026-01-11T04:14:48.482+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: TEL
[2026-01-11T04:14:53.410+0000] {logging_mixin.py:188} INFO - ❌ Lỗi income_statement: RetryError[<Future at 0x7f49d4ba82c0 state=finished raised KeyError>]
[2026-01-11T04:14:59.361+0000] {logging_mixin.py:188} INFO - ❌ Lỗi balance_sheet: RetryError[<Future at 0x7f49d4bab0e0 state=finished raised KeyError>]
[2026-01-11T04:15:05.336+0000] {logging_mixin.py:188} INFO - ❌ Lỗi cash_flow: RetryError[<Future at 0x7f49d4baa780 state=finished raised KeyError>]
[2026-01-11T04:15:08.837+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: TEG
[2026-01-11T04:15:18.559+0000] {logging_mixin.py:188} INFO -  >> Đang lấy dữ liệu: TED
[2026-01-11T04:15:29.653+0000] {logging_mixin.py:188} INFO -  ✓ Hoàn thành batch. Tổng số dòng: 4534
[2026-01-11T04:15:29.704+0000] {base.py:84} INFO - Using connection ID 'minio_finance' for task execution.
[2026-01-11T04:15:29.705+0000] {connection_wrapper.py:384} INFO - AWS Connection (conn_id='minio_finance', conn_type='aws') credentials retrieved from login and password.
[2026-01-11T04:15:30.188+0000] {datalake_df2csv.py:52} INFO - ✅ Đã upload 4534 dòng -> s3://thongtin-congty-va-bctc/bctc/date=2026-01-11/year=2024/batch_16.csv
[2026-01-11T04:15:30.190+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2026-01-11T04:15:30.204+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=bctc, task_id=ingest_bctc, run_id=manual__2026-01-11T04:06:44+00:00, map_index=16, execution_date=20260111T040644, start_date=20260111T041202, end_date=20260111T041530
[2026-01-11T04:15:30.261+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2026-01-11T04:15:30.304+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2026-01-11T04:15:30.307+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
